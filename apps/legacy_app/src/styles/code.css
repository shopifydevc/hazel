:root {
  /* Map light theme variables */
  --highlight-background: var(--card, oklch(1.00 0 0)); /* Fallback to white */
  --highlight-foreground: var(--card-foreground, oklch(0.34 0.01 2.77)); /* Default text */
  --highlight-comment: var(--muted-foreground, oklch(0.55 0.01 58.07)); /* Muted text for comments */
  --highlight-keyword: var(--primary, oklch(0.74 0.16 34.71)); /* Primary color for keywords */
  --highlight-string: var(--accent, oklch(0.83 0.11 58.00)); /* Accent color for strings */
  --highlight-number: var(--chart-4, oklch(0.82 0.11 40.89)); /* A chart color for numbers/literals */
  --highlight-function: var(--chart-2, oklch(0.83 0.11 58.00)); /* Another chart color for functions/classes */
  --highlight-tag: var(--secondary, oklch(0.96 0.02 28.90)); /* Secondary for HTML tags */
  --highlight-attribute: var(--chart-5, oklch(0.64 0.13 32.07)); /* Another chart color for attributes */
  --highlight-builtin: var(--secondary-foreground, oklch(0.56 0.13 32.74)); /* Secondary text for built-ins */
  --highlight-punctuation: var(--muted-foreground, oklch(0.55 0.01 58.07)); /* Muted for punctuation */
  --highlight-variable: var(--card-foreground, oklch(0.34 0.01 2.77)); /* Default for variables */
  --highlight-meta: var(--primary, oklch(0.74 0.16 34.71)); /* Primary for meta tags */

  --highlight-border-color: var(--border, oklch(0.93 0.04 38.69));
  --highlight-radius: var(--radius-lg, 0.625rem); /* Use large radius */
  --highlight-font-mono: var(--font-mono, 'Ubuntu Mono', monospace);

  /* Button specific vars (can reuse theme vars or define new ones) */
  --highlight-button-bg: var(--muted, oklch(0.97 0.02 39.40));
  --highlight-button-fg: var(--muted-foreground, oklch(0.55 0.01 58.07));
  --highlight-button-border: var(--border, oklch(0.93 0.04 38.69));
  --highlight-button-hover-bg: var(--secondary, oklch(0.96 0.02 28.90));
}

.dark {
  /* Map dark theme variables */
  --highlight-background: var(--card, oklch(0.20 0.01 338.46)); /* Dark card bg */
  --highlight-foreground: var(--card-foreground, oklch(0.94 0.01 51.32)); /* Light text */
  --highlight-comment: var(--muted-foreground, oklch(0.84 0.02 52.63));
  --highlight-keyword: var(--primary, oklch(0.74 0.16 34.71)); /* Keep primary consistent */
  --highlight-string: var(--accent, oklch(0.83 0.11 58.00)); /* Keep accent consistent */
  --highlight-number: var(--chart-4, oklch(0.82 0.11 40.89));
  --highlight-function: var(--chart-2, oklch(0.83 0.11 58.00));
  --highlight-tag: var(--secondary-foreground, oklch(0.94 0.01 51.32)); /* Use lighter secondary text for tags in dark */
  --highlight-attribute: var(--chart-5, oklch(0.64 0.13 32.07));
  --highlight-builtin: var(--muted-foreground, oklch(0.84 0.02 52.63)); /* Use muted foreground for builtins */
  --highlight-punctuation: var(--muted-foreground, oklch(0.84 0.02 52.63));
  --highlight-variable: var(--card-foreground, oklch(0.94 0.01 51.32)); /* Default dark text */
  --highlight-meta: var(--primary, oklch(0.74 0.16 34.71));

  --highlight-border-color: var(--border, oklch(0.32 0.02 341.45));
  --highlight-radius: var(--radius-lg, 0.625rem);
  --highlight-font-mono: var(--font-mono, 'Ubuntu Mono', monospace);

  /* Button specific vars for dark mode */
  --highlight-button-bg: var(--muted, oklch(0.32 0.02 341.45));
  --highlight-button-fg: var(--muted-foreground, oklch(0.84 0.02 52.63));
  --highlight-button-border: var(--border, oklch(0.32 0.02 341.45));
  --highlight-button-hover-bg: var(--secondary, oklch(0.36 0.02 342.27));
}

/* Base styles for code blocks using highlight.js */
pre.hljs-custom-block { /* Add a custom class to the <pre> tag if needed for targeting */
  position: relative; /* For copy button positioning */
  background-color: var(--highlight-background);
  color: var(--highlight-foreground);
  font-family: var(--highlight-font-mono);
  padding: 1em;
  padding-top: 2.8em; /* Make space for the button */
  margin: 1em 0;
  overflow: auto;
  border-radius: var(--highlight-radius);
  border: 1px solid var(--highlight-border-color);
  font-size: 0.9em; /* Slightly smaller font */
  line-height: 1.4;
}

/* Apply base styles directly to `code` inside `pre` generated by rehype-highlight */
pre code.hljs {
  display: block; /* Or inline depending on usage, block is typical */
  overflow-x: auto;
  padding: 0; /* Padding is on the parent 'pre' now */
  color: var(--highlight-foreground); /* Default color */
  background: none; /* Background is on the parent 'pre' */
  font-family: var(--highlight-font-mono);
}

/* Syntax Highlighting Styles using CSS Variables */
.hljs-comment,
.hljs-quote {
  color: var(--highlight-comment);
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst,
.hljs-literal, /* Often includes true/false/null */
.hljs-section, /* For markdown headings */
.hljs-type {   /* Class names */
  color: var(--highlight-keyword);
  font-weight: bold; /* Make keywords stand out */
}

.hljs-string,
.hljs-symbol, /* e.g., :ruby_symbol */
.hljs-bullet, /* Markdown list bullets */
.hljs-addition /* Git diff additions */ {
  color: var(--highlight-string);
}

.hljs-number,
.hljs-regexp, /* Regular expressions */
.hljs-link {
  color: var(--highlight-number);
}

.hljs-title, /* Often function names */
.hljs-class .hljs-title { /* Explicitly class names */
  color: var(--highlight-function);
  font-weight: bold;
}

.hljs-tag,
.hljs-name /* Often HTML tag names */ {
  color: var(--highlight-tag);
  /* font-weight: bold; */ /* Optional bold */
}

.hljs-attribute {
  color: var(--highlight-attribute);
}

.hljs-built_in,
.hljs-builtin-name,
.hljs-variable,
.hljs-template-variable {
  color: var(--highlight-builtin);
}

.hljs-meta,
.hljs-meta-keyword,
.hljs-meta-string {
    color: var(--highlight-meta);
    font-weight: bold;
}

.hljs-punctuation {
    color: var(--highlight-punctuation);
}


.hljs-deletion {
  color: var(--highlight-string); /* Use string color for deletion */
  background-color: var(--destructive); /* Use destructive bg for diffs */
  display: inline-block; /* Ensure bg covers */
  width: 100%; /* Ensure bg covers full line */
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

/* Style for the Copy Button inside the PreWithCopy component */
/* (Adapt the selector if your component renders differently) */
pre > button.hljs-copy-button { /* Target button directly inside pre */
  position: absolute;
  top: 0.5em;
  right: 0.5em;
  padding: 0.25em 0.6em;
  font-size: 0.8em; /* Relative to pre's font size */
  font-family: var(--font-sans, sans-serif); /* Use sans-serif for button */
  cursor: pointer;
  border-radius: var(--radius-sm, calc(0.625rem - 4px));
  border: 1px solid var(--highlight-button-border);
  background-color: var(--highlight-button-bg);
  color: var(--highlight-button-fg);
  z-index: 1;
  transition: background-color 0.2s ease;
}

pre > button.hljs-copy-button:hover {
  background-color: var(--highlight-button-hover-bg);
}

/* Optional: Style for button when copied */
pre > button.hljs-copy-button.copied {
    background-color: var(--highlight-keyword); /* Use keyword color temporarily */
    color: var(--primary-foreground); /* Text color on primary bg */
}